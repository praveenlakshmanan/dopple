<div class="modal-header">
   <button type="button" class="close" data-dismiss="modal" aria-hidden="true">ÃÂ</button> 
   <h3>{{share.title}} <small>shareable link</small></h3>
</div>
<div class="modal-body"><label>Share this dashboard with this URL</label><input id="email-link" ng-model="share.link" type="text" style="width:90%" onclick="this.select()" onfocus="this.select()" ng-change="share = dashboard.share_link(share.title,share.type,share.id)"></div>
</div><br>
<section style="padding-left:15px">Share via email</section>
<div style="width:100%;margin-top:10px;"><label style="padding-left:15px">Email-id :<input id="email-id" type="text"style="margin-left:10px"/></label>
<label style="padding-left:15px;margin-top:10px;">Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:
<select id="type" style="margin-left:5px"><option value="png">png</option><option value="pdf">pdf</option></select><button id="sendbtn" style="margin-left:10px;margin-bottom:10px" onclick="emailType()" class="btn btn-success">send</button>
</label>
</div>
<div class="modal-footer"><button id="close" ng-click="dismiss();$broadcast('render')" class="btn btn-success" type="button">Close</button></div>

<script type="text/javascript" >

function emailType(){
	 var emailLink = document.getElementById("email-link").value;
	 var emailId = document.getElementById("email-id").value;
	 var type = document.getElementById("file_format").value;
	 //alert(type);
	 email(emailLink,type,emailId);	 	
}

function email(link,type,id){
	 var idArr = id.split(",");
	   for(i=0;i < idArr.length;i++){
	   	flag = validateEmail(idArr[i]);
	   	
	   	if(flag.toString() == "false"){
	   		    break;
	   	};
	   }
	if(id != "" && flag.toString() =="true"){
		var title = document.getElementById("brand").value;
		var textField = document.getElementById("email-id");
		textField.style.border = "1px solid #1dade2";
		
		var xmlhttp;
		if (window.XMLHttpRequest){
		// code for IE7+, Firefox, Chrome, Opera, Safari
 					 xmlhttp=new XMLHttpRequest();
 		}else{// code for IE6, IE5
  			xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  		}
		xmlhttp.onreadystatechange=function(){
  			if (xmlhttp.readyState==4 && xmlhttp.status==200){
  				alert(xmlhttp.responseText);
    		}
  		}
		var parameters = "url="+encodeURIComponent(link)+"&type="+encodeURIComponent(type)+"&id="+encodeURIComponent(id)+"&title="+encodeURIComponent(title);
		//var data = [{"url":link,"type":type}];
		//alert(JSON.stringify(data));al
		
		xmlhttp.open("POST","MailReport",true);
		xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		xmlhttp.send(parameters);
		document.getElementById("close").click();
		
	}else{
		var textField = document.getElementById("email-id");
		textField.style.border = "1px solid red";
}
}
 function validateEmail(isEmail) { 
             var filter = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
             if (filter.test(isEmail)) {
                  return true;
                }
             else {
                return false;
              }
          }
</script>